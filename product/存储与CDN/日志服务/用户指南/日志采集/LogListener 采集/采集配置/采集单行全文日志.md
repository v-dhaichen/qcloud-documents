## 概述

单行全文日志是指一行日志内容为一条完整的日志。日志服务在采集的时候，将使用换行符 `\n` 来作为一条日志日志的结束符。为了统一结构化管理，每条日志都会存在一个默认的键值 `__CONTENT__`，但日志数据本身不再进行日志结构化处理，也不会提取日志字段，日志属性的时间项由日志采集的时间决定。

### 示例

假设您的一条日志原始数据为：

```
Tue Jan 22 12:08:15 CST 2019 Installed: libjpeg-turbo-static-1.2.90-6.el7.x86_64
```

日志最终被日志服务处理为：

```
__CONTENT__:Tue Jan 22 12:08:15 CST 2019 Installed: libjpeg-turbo-static-1.2.90-6.el7.x86_64
```

## 采集配置

### 1. 登录控制台

登录 [日志服务控制台](https://console.cloud.tencent.com/cls)，左侧选择【日志集管理】。

### 2. 新建 LogListener 采集

选择目标日志集，单击【新建日志主题】，输入日志主题名称：test-full ，单击【确定】。
![](https://main.qcloudimg.com/raw/528377a52b7474d3919b96b94271c7cf.png)

### 3. 配置 LogListener 采集

单击 LogListener 采集的日志主题，在采集配置界面中单击右上角【编辑】按钮，进入到编辑模式，然后开启**采集状态**和**使用 LogListener**。
![img](https://main.qcloudimg.com/raw/23cace59adf0a6fa2f8c30d4c76f59b5.png)

### 4. 配置日志文件采集路径

日志采集路径需分别指定日志前缀目录和文件名，支持通配符`*`和`？`两种方式。路径匹配规则支持多层目录匹配，即指定目录前缀后，会监听到所有子层目录中符合采集文件名规则的日志文件，参数说明如下：

| 字段     | 说明                                      |
| -------- | ----------------------------------------- |
| 目录前缀 | 日志文件前缀目录结构，支持通配符`*`和`？` |
| 文件名   | 日志文件名，支持通配符`*`和`？`           |

例如，目录前缀是 `/var/logs/app_*`，文件名是`*.log`，则agent会监听`/var/log`下所有`app_*` 模式的以`.log`为后缀名的日志文件。

>!
1. 多层目录和通配符配置方式依赖 loglistener 版本2.2.2及以上，为兼容低版本 loglistener 路径配置修改方式，用户可切换旧配置进行历史修改，旧采集路径方式不支持多目录采集。
2. 一个日志文件只能被一个日志主题采集。

### 5. 关联机器组

从机器组列表中选择目标机器组，将其与当前日志主题进行关联，值得注意的是，关联的机器组与日志主题所在的地域需保持一致。操作详情请参阅 [如何创建机器组](https://cloud.tencent.com/document/product/614/17412#.E5.88.9B.E5.BB.BA.E6.9C.BA.E5.99.A8.E7.BB.84) 文档。
![](https://main.qcloudimg.com/raw/4e110aae8383c318c641c6352b78e451.png)

### 6. 单行全文模式选择

【键值提取模式】下拉选择**单行全文**，如下图所示：
![](https://main.qcloudimg.com/raw/7660d393badda7bc4420cf9164a39b1a.png)

### 7. 过滤器条件

过滤器旨在您根据业务需要添加日志采集过滤规则，帮助您方便筛选出有价值的日志数据。对于 JSON 格式日志，可以根据所解析成的键值对配置过滤规则，过滤规则为正则表达式。所创建的过滤规则为命中规则，即匹配上正则表达式的日志才会被采集上报。

例如，您希望指定 status = 400或500的日志数据被采集。key 处配置 status，过滤规则处配置（400|500）。

### 8. 检索结果

登录 [日志服务控制台](https://console.cloud.tencent.com/cls)，左侧选择日志检索，选择日志集与日志主题，单击【搜索】。
![img](https://main.qcloudimg.com/raw/a9d44b05d0072299076d9df24c75bda7.png)

>!检索必须开启索引配置，否则无法进行检索。
